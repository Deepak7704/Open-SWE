// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}


model Installation {
  id              Int       @id @default(autoincrement())
  installationId  Int       @unique
  accountLogin    String    //github user name or organization name
  accountType     String    // 'User' or 'Organization'
  installedAt     DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
  deletedAt       DateTime? 
  
  repositories    Repository[]
}

model Repository {
  id             Int       @id @default(autoincrement())
  githubId       Int       @unique //github's internal database id for the repo
  name           String     //only the repository name
  fullName       String    @unique //username and reponame that act as key
  private        Boolean   @default(false)
  addedAt        DateTime  @default(now())
  removedAt      DateTime? 
  
  installationId Int
  installation   Installation @relation(fields: [installationId], references: [installationId], onDelete: Cascade)
  
  @@index([fullName])
  @@index([installationId])
}
